name: Deploy via SFTP

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: üöö Get latest code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: üßπ Remove unwanted files
        # –£–¥–∞–ª—è–µ–º –≤—Å—ë –ª–∏—à–Ω–µ–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        # –í —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ –ø–µ—Ä–µ—á–∏—Å–ª–∏ –≤—Å—ë, —á—Ç–æ –ù–ï —Ö–æ—á–µ—à—å –≤–∏–¥–µ—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
        run: rm -rf .git .github .vscode .DS_Store node_modules README.md .env test

      - name: üìÇ SFTP Deploy
        uses: wlixcc/SFTP-Deploy-Action@v1.2.4
        with:
          username: ${{ secrets.SFTP_USER }}
          server: ${{ secrets.SFTP_HOST }}
          port: 2222
          ssh_password: ${{ secrets.SFTP_PASSWORD }}
          local_path: './'
          remote_path: '/slovotron.fra3a.ru/'
          sftp_only: true